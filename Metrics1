const sheets = SpreadsheetApp.getActiveSpreadsheet().getSheets()
const metricsSheet = sheets[1]
var i

function copyAll() {
  for (i = 4; i < sheets.length; i++) {
    copy(i)
  }
}

function copy(i) {
  //ranges within the metrics sheet
  const ticketName_range = 'A' + (i-2)
  const reportDate_range = 'B' + (i-2)
  const familyID_range = 'C' + (i-2)
  //const language_range = 'D' + (i-2)
  const reportedVia_range = 'D' + (i-2)
  const respTime_range = 'E' + (i-2)
  const status_range = 'F' + (i-2)
  const openCloseStatus_range = 'G' + (i-2)
  const satisfaction_range = 'H' + (i-2)
  const resolutionDate_range = 'I' + (i-2)
  metricsSheet.getRange(ticketName_range).setValue(sheets[i].getRange('B2').getValue())
  metricsSheet.getRange(reportDate_range).setValue(sheets[i].getRange('B4').getValue())
  metricsSheet.getRange(familyID_range).setValue(sheets[i].getRange('B9').getValue())
  //metricsSheet.getRange(language_range).setValue(sheets[i].getRange('B10').getValue())
  metricsSheet.getRange(reportedVia_range).setValue(sheets[i].getRange('B8').getValue())
  metricsSheet.getRange(respTime_range).setValue(sheets[i].getRange('B14').getValue())
  metricsSheet.getRange(status_range).setValue(sheets[i].getRange('B16').getValue())
  metricsSheet.getRange(openCloseStatus_range).setValue(sheets[i].getRange('B17').getValue())
  metricsSheet.getRange(satisfaction_range).setValue(sheets[i].getRange('B20').getValue())
  metricsSheet.getRange(resolutionDate_range).setValue(sheets[i].getRange('B6').getValue())
}

//for manual entry on google sheets
function sheetName() {
  return SpreadsheetApp.getActiveSpreadsheet().getActiveSheet().getName()
}
function numberOfTickets() {
  return sheets.length - 4
}
